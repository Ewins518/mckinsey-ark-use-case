{{/*
Models - Deploy FIRST using pre-install hook
These resources are deployed before everything else and must be ready before agents can be created
*/}}
{{- if not .Values.excludeResources }}
{{- range $path, $_ := .Files.Glob "models/*.yaml" }}
---
{{- $content := $.Files.Get $path }}
{{- $content | replace "metadata:" "metadata:\n  annotations:\n    \"helm.sh/hook\": pre-install,pre-upgrade\n    \"helm.sh/hook-weight\": \"-10\"\n    \"helm.sh/hook-delete-policy\": before-hook-creation" }}
{{- end }}
{{- end }}